<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lastik Bilgileri – Konu Kartları</title>
<style>
  :root{
    --bg:#0e1117; --fg:#e6e9ef; --muted:#9aa3ad; --card:#171b22; --card2:#141923;
    --accent:#4cc3ff; --ring:#2a3344; --radius:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    color:var(--fg);
    background: radial-gradient(1200px 600px at 10% -10%, #1b2130 0%, transparent 60%) ,
                radial-gradient(1000px 500px at 110% 0%, #162034 0%, transparent 60%) ,
                linear-gradient(#0c1016, #0e1117 40%, #0b0e14);
    min-height:100dvh;
  }
  header{ padding:28px 16px 12px; text-align:center;}
  header h1{margin:0 0 6px; font-weight:800; letter-spacing:.2px;}
  header p{margin:0; color:var(--muted)}

  .container{width:min(1100px,92vw); margin:12px auto 56px;}
  .toolbar{display:flex; gap:10px; align-items:center; margin: 10px 0 18px;}
  .search{
    flex:1; padding:12px 14px; border-radius:12px; border:1px solid var(--ring);
    background:#0f1521; color:var(--fg); outline:none;
  }

  .grid{
    display:grid; gap:18px;
    grid-template-columns: repeat(auto-fill, minmax(290px,1fr));
  }
  .card{
    background: linear-gradient(180deg, var(--card), var(--card2));
    border: 1px solid #20283a; border-radius: var(--radius);
    overflow: clip; display:flex; flex-direction:column; min-height:100%;
    box-shadow: 0 12px 28px rgba(0,0,0,.35);
    transition: transform .15s ease, border-color .15s ease, box-shadow .15s ease;
  }
  .card:hover{ transform: translateY(-2px); border-color:#2e3a55; box-shadow:0 16px 34px rgba(0,0,0,.45);}
  .thumb{ width:100%; aspect-ratio: 16/9; object-fit:cover; background:#0c1119; display:block;}

  /* Placeholder görsel (image_url null ise) */
  .placeholder{
    display:grid; place-items:center; aspect-ratio:16/9; background:
      repeating-linear-gradient(135deg, #121826 0 22px, #0f1521 22px 44px);
    border-bottom:1px solid #1f2940;
  }
  .ph-badge{
    display:inline-flex; align-items:center; gap:8px;
    padding:8px 12px; border-radius:12px; background:#111929; color:#a7b1be;
    border:1px solid #2a3346; font-size:.9rem; font-weight:700;
  }
  .ph-badge svg{opacity:.9}

  .body{ padding:14px 16px 18px; display:flex; flex-direction:column; gap:10px; }
  .title{ font-size:1.08rem; font-weight:800; line-height:1.3; letter-spacing:.1px;}
  .kicker{
    display:inline-flex; align-items:center; gap:8px; font-size:.73rem; font-weight:800;
    background:var(--accent); color:#0b101a; padding:4px 10px; border-radius:999px;
    width:max-content;
  }
  .desc{ color:#e9ecf2; opacity:.96; font-size:.96rem;}
  .desc p{margin:.55em 0}
  .desc ul{margin:.45em 0 .2em 1.1em}
  .desc li{margin:.25em 0}
  .meta{ color:var(--muted); font-size:.8rem; margin-top:2px }

  .empty{color:#92a0b3; text-align:center; padding:36px}
  footer{color:#6e7887; text-align:center; padding:28px 0 36px; font-size:.85rem;}
</style>
</head>
<body>
  <header>
    <h1>Lastik Bilgileri</h1>
    <p>Konu kartları • JSON’dan otomatik yüklenir</p>
  </header>

  <main class="container">
    <div class="toolbar">
      <input id="q" class="search" type="search" placeholder="Ara: başlık & içerik (örn. kesit, diş, hız endeksi)"/>
    </div>

    <section id="grid" class="grid" aria-live="polite"></section>
    <div id="empty" class="empty" hidden>Sonuç bulunamadı.</div>
  </main>

  <footer>Kaynak: <code>topic.json</code> • GitHub Pages ile yayınlanmıştır</footer>

<script>
/* Basit Markdown -> HTML (kalın, listeler) */
function mdToHTML(md){
  if(!md) return "";
  let html = md.replace(/\*\*(.+?)\*\*/g, "<strong>$1</strong>");
  const lines = html.split(/\r?\n/);
  let out="", inList=false;
  for(const ln of lines){
    const m = ln.match(/^\s*\*\s+(.*)$/);
    if(m){
      if(!inList){ out+="<ul>"; inList=true; }
      out += `<li>${m[1]}</li>`;
    }else{
      if(inList){ out+="</ul>"; inList=false; }
      if(ln.trim()==="") continue;
      out += `<p>${ln}</p>`;
    }
  }
  if(inList) out+="</ul>";
  return out;
}

const grid = document.getElementById("grid");
const empty = document.getElementById("empty");
const q = document.getElementById("q");
let DATA = [];

/* topic.json aynı dizinde olmalı */
fetch("topic.json",{cache:"no-store"})
  .then(r => { if(!r.ok) throw new Error("topic.json bulunamadı"); return r.json(); })
  .then(json => { DATA = Array.isArray(json)? json : (json.items||[]); render(DATA); })
  .catch(err => { grid.innerHTML = `<div class="empty">Hata: ${err.message}</div>`; });

function render(items){
  if(!items.length){ grid.innerHTML=""; empty.hidden=false; return; }
  empty.hidden=true;
  grid.innerHTML = items.map(cardHTML).join("");
  // Lazy load
  for(const img of grid.querySelectorAll("img[data-src]")){
    img.src = img.dataset.src; img.removeAttribute("data-src");
  }
}

function cardHTML({id, title, image_url, description}){
  const hasImg = !!(image_url && image_url.trim());
  const titleHtml = escapeHTML(title||"");
  const descHtml = mdToHTML(description||"");

  const media = hasImg
    ? `<img class="thumb" loading="lazy" alt="${titleHtml}" data-src="${image_url}">`
    : `<div class="placeholder">
         <span class="ph-badge" title="Görsel yok">
           ${iconTire()}
           Görsel bulunamadı
         </span>
       </div>`;

  return `
  <article class="card" data-id="${id??""}">
    ${media}
    <div class="body">
      <span class="kicker">#${id??"—"}</span>
      <div class="title">${titleHtml}</div>
      <div class="meta"></div>
      <div class="desc">${descHtml}</div>
    </div>
  </article>`;
}

function escapeHTML(s){ return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

function iconTire(){
  /* küçük SVG ikon */
  return `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <circle cx="12" cy="12" r="10" stroke="#7ea0c8" stroke-width="1.4"/>
    <circle cx="12" cy="12" r="4" stroke="#7ea0c8" stroke-width="1.4"/>
  </svg>`;
}

function filter(term){
  term = term.trim().toLowerCase();
  if(!term) return DATA;
  return DATA.filter(x =>
    (x.title||"").toLowerCase().includes(term) ||
    (x.description||"").toLowerCase().includes(term)
  );
}

q.addEventListener("input", () => render(filter(q.value)));
</script>
</body>
</html>
